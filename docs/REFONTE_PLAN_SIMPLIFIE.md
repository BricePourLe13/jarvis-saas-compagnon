# üöÄ PLAN DE REFONTE SIMPLIFI√â - KIOSKS UNIQUEMENT

**Date** : 23 octobre 2025  
**Version** : 1.0 - Simplifi√©  
**Scope** : Miroirs digitaux (kiosks) UNIQUEMENT - Mobile beaucoup plus tard

---

## üéØ OBJECTIF : RENDRE LE SYST√àME PROPRE, S√õR ET PRO

**P√©rim√®tre** :
- ‚úÖ Dashboards g√©rants (refonte compl√®te)
- ‚úÖ Syst√®me kiosks (am√©liorer, pas refondre)
- ‚úÖ S√©curit√© (isolation stricte par salle)
- ‚úÖ M√©triques r√©elles (fini Math.random())
- ‚ùå Mobile (pas maintenant)

**R√©sultat attendu** :
- Dashboard niveau entreprise
- Un g√©rant voit **UNIQUEMENT** sa salle
- Syst√®me kiosk stable et document√©
- M√©triques vraies pour d√©cisions business
- Architecture √©volutive (mais sans d√©velopper mobile)

---

## üìä PROBL√àMES ACTUELS (rappel)

### üî¥ Critique
1. **Pas d'auth sur dashboards** - N'importe qui peut acc√©der
2. **2 dashboards parall√®les** - `/dashboard` ET `/admin` (bordel)
3. **M√©triques fake** - `Math.random()` partout
4. **Isolation faible** - Un g√©rant pourrait voir d'autres salles

### üü† Important  
5. **Syst√®me kiosk basique** - Pas de device management
6. **Pas d'invitations** - Impossible d'ajouter un g√©rant
7. **Tables BDD inutilis√©es** - `member_analytics`, `manager_alerts`, etc.

### üü° Am√©liorable
8. **UX incoh√©rente** - Chaque page fait sa propre chose
9. **Logs au pif** - `console.log` partout
10. **Pas de monitoring** - Impossible de voir si √ßa marche

---

## üèóÔ∏è ARCHITECTURE CIBLE (simplifi√©)

### Hi√©rarchie dashboards (UN SEUL SYST√àME)

```
/dashboard                    ‚Üê UN SEUL dashboard
  ‚îú‚îÄ‚îÄ middleware.ts           ‚Üê üîí Auth + permissions
  ‚îÇ
  ‚îú‚îÄ‚îÄ /                       ‚Üê Redirect selon r√¥le
  ‚îÇ
  ‚îú‚îÄ‚îÄ (super-admin)/
  ‚îÇ   ‚îú‚îÄ‚îÄ /overview           ‚Üê Vue globale JARVIS-GROUP
  ‚îÇ   ‚îú‚îÄ‚îÄ /franchises         ‚Üê Liste toutes franchises
  ‚îÇ   ‚îî‚îÄ‚îÄ /system             ‚Üê Monitoring + config
  ‚îÇ
  ‚îú‚îÄ‚îÄ (franchise-owner)/
  ‚îÇ   ‚îî‚îÄ‚îÄ /franchise/[id]
  ‚îÇ       ‚îú‚îÄ‚îÄ /               ‚Üê Vue d'ensemble franchise
  ‚îÇ       ‚îî‚îÄ‚îÄ /gyms           ‚Üê Liste salles de la franchise
  ‚îÇ
  ‚îú‚îÄ‚îÄ (gym-manager)/          ‚Üê üéØ VUE PRINCIPALE
  ‚îÇ   ‚îî‚îÄ‚îÄ /gym/[id]
  ‚îÇ       ‚îú‚îÄ‚îÄ /               ‚Üê Dashboard SALLE (vue unique)
  ‚îÇ       ‚îú‚îÄ‚îÄ /members        ‚Üê Adh√©rents de cette salle
  ‚îÇ       ‚îú‚îÄ‚îÄ /sessions       ‚Üê Conversations JARVIS
  ‚îÇ       ‚îú‚îÄ‚îÄ /analytics      ‚Üê M√©triques + graphiques
  ‚îÇ       ‚îú‚îÄ‚îÄ /alerts         ‚Üê Alertes intelligentes (nouveau)
  ‚îÇ       ‚îî‚îÄ‚îÄ /settings       ‚Üê Config salle + kiosk
  ‚îÇ
  ‚îî‚îÄ‚îÄ (shared)/
      ‚îú‚îÄ‚îÄ /team               ‚Üê Invitations + gestion √©quipe
      ‚îî‚îÄ‚îÄ /profile            ‚Üê Profil utilisateur

/admin                        ‚Üê ‚ùå SUPPRIM√â (tout fusionn√©)

/kiosk/[slug]                 ‚Üê ‚úÖ GARD√â (interface miroir)
```

**Changements** :
- ‚ùå Supprimer `/admin` compl√®tement
- ‚úÖ UN SEUL syst√®me dashboard avec r√¥les
- ‚úÖ Dashboard salle = vue isol√©e (un g√©rant = une salle)
- ‚úÖ Kiosks gard√©s tels quels (juste am√©lior√©s)

### Syst√®me kiosks (am√©lior√©, pas refondre)

**Actuel** :
```
Kiosk physique
  ‚Üì
  URL: /kiosk/{slug}
  ‚Üì
  Badge RFID scann√©
  ‚Üì
  Session JARVIS
```

**Am√©liorations** :
1. **Provisioning propre** : Code d'activation + heartbeat
2. **Monitoring** : Status online/offline visible dashboard
3. **Config centralis√©e** : G√©rant peut changer voix/mod√®le depuis dashboard
4. **Logs structur√©s** : Plus de `console.log`, logs BDD

**PAS de changements** :
- ‚úÖ URL `/kiosk/{slug}` gard√©e
- ‚úÖ Syst√®me RFID gard√©
- ‚úÖ Flow actuel gard√©

---

## üìÖ PLAN D'ACTION (3 PHASES)

### üî¥ PHASE 1 : S√âCURIT√â + NETTOYAGE (Semaine 1-2)

**Objectif** : Prot√©ger les dashboards + supprimer `/admin`

#### 1.1 Middleware Auth (2 jours)
```typescript
// src/middleware.ts
export function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl
  
  // üîí Prot√©ger TOUS les dashboards
  if (pathname.startsWith('/dashboard')) {
    const user = await getAuthUser(request)
    
    if (!user) {
      return NextResponse.redirect('/login')
    }
    
    // V√©rifier acc√®s selon r√¥le
    if (!canAccessRoute(user, pathname)) {
      return NextResponse.json({ error: 'Acc√®s refus√©' }, { status: 403 })
    }
  }
  
  return NextResponse.next()
}
```

**Livrables** :
- [ ] Middleware auth complet
- [ ] Protection toutes routes `/dashboard`
- [ ] Redirection auto selon r√¥le
- [ ] Tests E2E auth

#### 1.2 Fusion `/admin` ‚Üí `/dashboard` (3 jours)
```bash
# Migrations
/admin/franchises    ‚Üí /dashboard/(super-admin)/franchises
/admin/sessions/live ‚Üí /dashboard/(shared)/sessions
/admin/team          ‚Üí /dashboard/(shared)/team
/admin/monitoring    ‚Üí /dashboard/(super-admin)/system
```

**Livrables** :
- [ ] Nouvelle structure dossiers
- [ ] Redirects 301 anciennes routes
- [ ] Navigation unifi√©e
- [ ] Suppression dossier `/admin`

#### 1.3 RLS Strict + Helpers (2 jours)
```typescript
// src/lib/secure-queries.ts
export async function getGymDataSecure(gymId: uuid, userId: uuid) {
  // ‚úÖ V√©rifie TOUJOURS l'acc√®s avant de renvoyer data
  const hasAccess = await checkUserHasGymAccess(userId, gymId)
  if (!hasAccess) throw new ForbiddenError()
  
  return supabase.from('gyms').select('*').eq('id', gymId).single()
}
```

**Livrables** :
- [ ] Helpers s√©curis√©s pour queries sensibles
- [ ] Audit logs (table `audit_trail`)
- [ ] Tests s√©curit√© (isolation par salle)

---

### üü† PHASE 2 : DASHBOARDS PROPRES (Semaine 3-5)

**Objectif** : Dashboard salle niveau entreprise

#### 2.1 Dashboard Salle - Vue principale (5 jours)

**Route** : `/dashboard/gym/[id]`

**Page d'accueil salle** :
```typescript
// Sections affich√©es
1. Header
   - Nom salle
   - Status kiosk (online/offline)
   - Quick actions (inviter staff, cr√©er mission)

2. M√©triques cl√©s (4 cards)
   - Membres actifs (vs mois dernier)
   - Sessions aujourd'hui (vs hier)
   - Churn risk HIGH (combien)
   - Satisfaction (score /5)

3. Alertes urgentes (top 3)
   - Ex: "5 membres √† risque de churn"
   - Ex: "Kiosk offline depuis 2h"
   - Ex: "10 feedbacks n√©gatifs cette semaine"

4. Graphiques tendances
   - Sessions par jour (7 derniers jours)
   - Satisfaction par semaine (4 derni√®res semaines)
```

**Livrables** :
- [ ] Page overview cr√©√©e
- [ ] Composants r√©utilisables (MetricCard, AlertCard)
- [ ] M√©triques R√âELLES (queries BDD)
- [ ] Graphiques (recharts)
- [ ] Responsive mobile

#### 2.2 Pages secondaires salle (5 jours)

**1. Members** (`/gym/[id]/members`)
```typescript
// Liste adh√©rents avec filtres
- Tous
- Churn risk √©lev√©
- Inactifs (>30 jours)
- Nouveaux (ce mois)

// Actions
- Voir fiche d√©taill√©e
- Exporter CSV
- Filtrer par objectifs
```

**2. Sessions** (`/gym/[id]/sessions`)
```typescript
// Conversations JARVIS en temps r√©el
- Liste sessions live + r√©centes
- Dur√©e, transcripts, sentiment
- Filtres par date, membre, sentiment
```

**3. Analytics** (`/gym/[id]/analytics`)
```typescript
// Graphiques avanc√©s
- Fr√©quentation par heure/jour
- Taux de r√©tention
- Objectifs atteints
- Exports PDF/CSV
```

**4. Alerts** (`/gym/[id]/alerts`) ‚Üê **NOUVEAU**
```typescript
// Table manager_alerts affich√©e
- Tri par priorit√© (urgent ‚Üí low)
- Actions recommand√©es par IA
- R√©solution + notes
- Historique
```

**5. Settings** (`/gym/[id]/settings`)
```typescript
// Config salle + kiosk
- Voix JARVIS (verse, alloy, etc.)
- Mod√®le AI (mini vs full)
- Branding (couleurs, logo)
- Horaires salle
- Status kiosk (online/offline)
```

**Livrables** :
- [ ] 5 pages cr√©√©es
- [ ] Navigation fluide
- [ ] Filtres fonctionnels
- [ ] Exports CSV/PDF
- [ ] Tests E2E dashboard

#### 2.3 M√©triques r√©elles (3 jours)
```typescript
// Fini les Math.random() !
const metrics = {
  active_members: await countActiveMembers(gymId),
  sessions_today: await countSessionsToday(gymId),
  churn_risk_high: await countMembersChurnRisk(gymId, 'high'),
  avg_satisfaction: await calculateAvgSatisfaction(gymId, '30d')
}

// Cache Redis pour perf
await redis.set(`metrics:${gymId}`, metrics, 'EX', 300) // 5min cache
```

**Livrables** :
- [ ] Fonctions calcul m√©triques
- [ ] Cache Redis (Upstash Free tier)
- [ ] Background job refresh (cron)
- [ ] Tests unitaires

#### 2.4 Syst√®me d'invitations (2 jours)
```typescript
// /dashboard/(shared)/team
- Inviter un staff/g√©rant
- Email automatique (Resend)
- Flow: invitation ‚Üí acceptation ‚Üí acc√®s
- R√©voquer acc√®s
```

**Livrables** :
- [ ] Page `/team` compl√®te
- [ ] API `/api/invitations`
- [ ] Emails templates (Resend)
- [ ] Tests flow complet

---

### üü° PHASE 3 : ANALYTICS + POLISH (Semaine 6-7)

**Objectif** : Utiliser tables analytics + polish UX

#### 3.1 Int√©gration tables analytics (3 jours)
```typescript
// Utiliser member_analytics, manager_alerts, insights_reports
const alerts = await getManagerAlerts(gymId, { status: 'pending' })
const insights = await getWeeklyInsights(gymId)
const churnMembers = await getMembersAtRisk(gymId, 0.7)
```

**Livrables** :
- [ ] `manager_alerts` affich√©es dashboard
- [ ] `insights_reports` g√©n√©r√©s auto (cron)
- [ ] `member_analytics` calcul√©es post-session
- [ ] Notifications email g√©rant

#### 3.2 Monitoring kiosks (2 jours)
```typescript
// Dashboard ‚Üí Settings ‚Üí Status kiosk
{
  status: 'online' | 'offline',
  last_heartbeat: '2025-10-23T14:30:00Z',
  uptime_percentage: 98.5,
  sessions_today: 45,
  avg_response_time: '350ms'
}
```

**Livrables** :
- [ ] Heartbeat system am√©lior√©
- [ ] Status visible dashboard
- [ ] Alertes si offline >15min
- [ ] Historique uptime

#### 3.3 Design system + polish (2 jours)
```typescript
// Composants standardis√©s
- DashboardCard (card g√©n√©rique)
- MetricCard (m√©trique avec trend)
- AlertCard (alerte avec priorit√©)
- MemberCard (fiche adh√©rent)
- SessionCard (conversation)
- GraphCard (graphique recharts)

// Palette couleurs unifi√©e
const colors = {
  primary: '#2563eb',
  success: '#10b981',
  warning: '#f59e0b',
  error: '#ef4444'
}
```

**Livrables** :
- [ ] Design system document√©
- [ ] Composants Storybook (optionnel)
- [ ] Guide style (Figma ou doc)
- [ ] UI coh√©rente partout

---

## üé® MAQUETTES DASHBOARD SALLE

### Vue d'ensemble (`/dashboard/gym/[id]`)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üèãÔ∏è PowerGym Lyon                    [‚ö° Kiosk: Online]      ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ  ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îÇ
‚îÇ ‚îÇ 245      ‚îÇ ‚îÇ 18       ‚îÇ ‚îÇ 12       ‚îÇ ‚îÇ 4.3/5    ‚îÇ        ‚îÇ
‚îÇ ‚îÇ Membres  ‚îÇ ‚îÇ Sessions ‚îÇ ‚îÇ Churn    ‚îÇ ‚îÇ Satisf.  ‚îÇ        ‚îÇ
‚îÇ ‚îÇ actifs   ‚îÇ ‚îÇ today    ‚îÇ ‚îÇ risk     ‚îÇ ‚îÇ score    ‚îÇ        ‚îÇ
‚îÇ ‚îÇ +5%      ‚îÇ ‚îÇ +2       ‚îÇ ‚îÇ üî¥       ‚îÇ ‚îÇ üòä       ‚îÇ        ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ üö® Alertes urgentes (3)                                      ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ üî¥ URGENT - 5 membres √† risque churn √©lev√©              ‚îÇ ‚îÇ
‚îÇ ‚îÇ    ‚Üí Action: Contacter dans les 48h                     ‚îÇ ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îÇ
‚îÇ ‚îÇ üü† WARNING - Kiosk offline 2x cette semaine             ‚îÇ ‚îÇ
‚îÇ ‚îÇ    ‚Üí Action: V√©rifier connexion r√©seau                  ‚îÇ ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îÇ
‚îÇ ‚îÇ üü° INFO - 10 feedbacks n√©gatifs √©quipements             ‚îÇ ‚îÇ
‚îÇ ‚îÇ    ‚Üí Action: Planifier maintenance                      ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ üìä Tendances (7 derniers jours)                              ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ     üìà Sessions                                          ‚îÇ ‚îÇ
‚îÇ ‚îÇ 60  ‚îå‚îÄ‚îê                                                  ‚îÇ ‚îÇ
‚îÇ ‚îÇ 40  ‚îÇ ‚îÇ ‚îå‚îÄ‚îê     ‚îå‚îÄ‚îê                                     ‚îÇ ‚îÇ
‚îÇ ‚îÇ 20  ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îå‚îÄ‚îê ‚îÇ ‚îÇ ‚îå‚îÄ‚îê ‚îå‚îÄ‚îê ‚îå‚îÄ‚îê                        ‚îÇ ‚îÇ
‚îÇ ‚îÇ  0  ‚îî‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ‚î¥‚îÄ                         ‚îÇ ‚îÇ
‚îÇ ‚îÇ     L   M   M   J   V   S   D                            ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ Quick Actions: [+ Inviter staff] [üìä Rapport] [‚öôÔ∏è Config]   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üí∞ ESTIMATION EFFORT

| Phase | Dur√©e | Focus | Priorit√© |
|-------|-------|-------|----------|
| Phase 1 - S√©curit√© | 2 semaines | Auth + nettoyage | üî¥ Critique |
| Phase 2 - Dashboards | 3 semaines | Dashboard salle | üü† Important |
| Phase 3 - Polish | 2 semaines | Analytics + UX | üü° Souhaitable |
| **TOTAL** | **7 semaines** | - | - |

**Ressources** : 1 dev fullstack senior

**Co√ªt opportunit√©** : ~‚Ç¨0 (juste votre temps)

---

## üìä M√âTRIQUES DE SUCC√àS

### Phase 1 (S√©curit√©)
- [ ] 100% routes dashboards prot√©g√©es
- [ ] 0 fuite de donn√©es entre salles
- [ ] Tests s√©cu passants
- [ ] Ancien `/admin` supprim√©

### Phase 2 (Dashboards)
- [ ] Dashboard salle <1s load time
- [ ] 100% m√©triques r√©elles (0 random)
- [ ] Invitations fonctionnelles
- [ ] 5 pages cr√©√©es + test√©es

### Phase 3 (Polish)
- [ ] Alertes affich√©es (<5min latency)
- [ ] Status kiosk visible
- [ ] Design coh√©rent partout
- [ ] Documentation compl√®te

---

## üöß RISQUES

### Risque 1 : Performance dashboards
**Impact** : Dashboards lents (>2s)  
**Mitigation** : Cache Redis + indexes BDD

### Risque 2 : Migration `/admin` ‚Üí `/dashboard`
**Impact** : Liens cass√©s  
**Mitigation** : Redirects 301 + tests E2E

### Risque 3 : M√©triques complexes
**Impact** : Queries lentes  
**Mitigation** : Background jobs + cache

---

## ‚úÖ CHECKLIST AVANT DE COMMENCER

### Validation
- [ ] Plan approuv√© par vous
- [ ] Backup BDD complet
- [ ] Environnement staging configur√©
- [ ] Tests E2E setup (Playwright)

### Technique
- [ ] Supabase access v√©rifi√©
- [ ] Redis (Upstash) configur√©
- [ ] Resend API key (emails invitations)
- [ ] Sentry configur√© (monitoring)

---

## üéØ PROCHAINES √âTAPES

**Si vous validez ce plan** :

### Cette semaine (Phase 1 kick-off)
1. Backup BDD + cr√©ation branch `refonte/phase-1`
2. Middleware auth (2 jours)
3. Fusion `/admin` ‚Üí `/dashboard` (3 jours)

### Semaine prochaine
4. RLS strict + helpers (2 jours)
5. Tests s√©curit√©
6. **Phase 1 termin√©e** ‚úÖ

---

## ‚ùì QUESTIONS OUVERTES

1. **Tests E2E** : Playwright obligatoire ou optionnel ?
2. **Cache** : Redis (Upstash) ou autre ?
3. **Emails** : Resend ou autre provider ?
4. **Design** : Garder Chakra UI ou migrer Shadcn/ui ?

---

**FIN DU PLAN SIMPLIFI√â**

**Architecture √©volutive** : On garde une structure qui POURRA accueillir mobile plus tard, mais on ne le d√©veloppe pas maintenant.

**Focus** : Kiosks + Dashboards, c'est tout. Simple, propre, pro.

